import{r as n,u as G,a as U,b as Y,j as e,L as z,B as S}from"./index-C23z5N7v.js";import{F as s}from"./Form-DmZ0uY2L.js";import{F as T,P as J,r as O,s as _,u as $,g as A}from"./firebaseonfig-BzPDJRzA.js";import{a as F}from"./axiosInstance-D6M-7RPN.js";const L={userEmail:"",userPassword:"",userName:"",userNumber:"",userImage:""},P={email:"",password:""};function W(){const[h,p]=n.useState(!0),[I,x]=n.useState(!1),[k,b]=n.useState(!1),j=n.useRef(null),f=n.useRef(null),[i,y]=n.useState(P),[l,g]=n.useState(L),[c,N]=n.useState(-1),w=G(),{handleUser:C}=U(),E=Y(),[o,R]=n.useState({}),v=a=>{y({...i,[a.target.name]:a.target.value})},V=a=>{a.preventDefault(),a.currentTarget.checkValidity()===!1?(a.stopPropagation(),x(!0)):F.post("auth/user/login",{userEmail:i.email,userPassword:i.password}).then(t=>{C(t.data),localStorage.setItem("userData",JSON.stringify(t.data)),y(P),f.current.reset(),w("/"),x(!1)}).catch(t=>{var r,u;R({error:!0,message:(u=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:u.message})})},d=a=>{g({...l,[a.target.name]:a.target.value})},D=a=>{const m=O(_,`/Users/${a[0].name}`),t=$(m,a[0]);t.on("state_changed",r=>{const u=Math.round(r.bytesTransferred/r.totalBytes*100);N(u)},r=>console.log(r),()=>{A(t.snapshot.ref).then(r=>{g({...l,userImage:{type:a[0].type,size:a[0].size,name:a[0].name,url:r}}),N(-1),console.log(r)})})},q=(a,m)=>{console.log("error code "+a.code+": "+a.message)},B=async a=>{a.preventDefault(),a.currentTarget.checkValidity()===!1?(a.stopPropagation(),b(!0)):F.post("auth/user/register",l).then(t=>{E.showSuccess("User register succesfully."),C(t.data),localStorage.setItem("userData",JSON.stringify(t.data)),g(L),b(!1),j.current.reset(),w("/")}).catch(t=>{console.log(t.response.data)})};return e.jsx("div",{className:"Login-container conatainer d-flex align-items-center justify-content-center h-100 position-relative",children:e.jsxs("div",{className:"Login-wrapper w-50",children:[e.jsx("h1",{className:"text-center login-logo",children:"VBlogs"}),h?e.jsx("h2",{className:"text-center mb-4",children:"Sign in to your account"}):e.jsx("h2",{className:"text-center mb-4",children:"Set up your account"}),h?e.jsxs(s,{noValidate:!0,validated:I,onSubmit:V,ref:f,children:[e.jsxs(s.Group,{className:"mb-4",controlId:"user-email",children:[e.jsx(s.Label,{children:"Email address"}),e.jsx(s.Control,{type:"email",placeholder:"Enter Your Email",name:"email",required:!0,onChange:v,value:i.email}),e.jsx(s.Control.Feedback,{type:"invalid",children:"Please enter valid email."})]}),e.jsxs(s.Group,{className:"mb-4",controlId:"user-password",children:[e.jsxs(s.Label,{className:"d-flex justify-content-between",children:[e.jsx("span",{children:"Password"})," ",e.jsx("span",{children:e.jsx(z,{to:"#",children:"Forgot Password"})})]}),e.jsx(s.Control,{type:"password",placeholder:"Enter Your Password",required:!0,minLength:6,max:20,name:"password",onChange:v,value:i.password}),e.jsx(s.Control.Feedback,{type:"invalid",children:"Password should contain min 6 and max 20 Chars."})]}),(o==null?void 0:o.error)&&e.jsx("p",{className:"text-small text-danger mt-0 mb-0",children:o==null?void 0:o.message}),e.jsx(S,{className:"btn signin-btn",type:"submit",children:"Login"})]}):e.jsxs(s,{noValidate:!0,validated:k,onSubmit:B,ref:j,children:[e.jsxs(s.Group,{className:"mb-4",controlId:"user-name",children:[e.jsx(s.Label,{children:"Full Name"}),e.jsx(s.Control,{type:"text",placeholder:"Enter Your name",name:"userName",required:!0,value:l.userName,onChange:d,minLength:6,maxLength:20}),e.jsx(s.Control.Feedback,{type:"invalid",children:"Name should be min 6 chars. long."})]}),e.jsxs(s.Group,{className:"mb-4",controlId:"user-email",children:[e.jsx(s.Label,{children:"Email address"}),e.jsx(s.Control,{type:"email",placeholder:"Enter Your Email",name:"userEmail",required:!0,value:l.userEmail,onChange:d}),e.jsx(s.Control.Feedback,{type:"invalid",children:"Please enter valid email."})]}),e.jsxs(s.Group,{className:"mb-4",controlId:"user-email",children:[e.jsx(s.Label,{children:"Phone number"}),e.jsx(s.Control,{type:"number",placeholder:"Enter Your number",name:"userNumber",required:!0,value:l.userNumber,onChange:d,pattern:"[0-9]{1,10}"}),e.jsx(s.Control.Feedback,{type:"invalid",children:"Please enter valid number."})]}),e.jsxs(s.Group,{className:"mb-4",controlId:"user-password",children:[e.jsxs(s.Label,{className:"d-flex justify-content-between",children:[e.jsx("span",{children:"Password"})," "]}),e.jsx(s.Control,{type:"password",placeholder:"Enter Your Password",required:!0,minLength:6,max:20,name:"userPassword",value:l.userPassword,onChange:d}),e.jsx(s.Control.Feedback,{type:"invalid",children:"Password should contain min 6 and max 20 Chars."})]}),e.jsxs("div",{className:"files mb-3",children:[e.jsx(T,{className:"files-dropzone",onChange:D,onError:q,accepts:["image/png","image/jpeg"],multiple:!1,maxFileSize:1e7,minFileSize:0,clickable:!0,name:"userImage"}),c>=0&&c<101&&e.jsx(J,{className:"mt-3",now:c,label:`${c}%`})]}),e.jsx(S,{className:"btn signin-btn",type:"submit",children:"Register"})]}),h?e.jsxs("p",{className:"mt-5 d-flex justify-content-evenly",children:["Not a member?",e.jsx("span",{role:"button",className:"signin-up",onClick:()=>p(!1),children:"Sign up here."})]}):e.jsxs("p",{className:"mt-5 d-flex justify-content-evenly",children:["Already a member?",e.jsx("span",{role:"button",className:"signin-up",onClick:()=>p(!0),children:"Sign In"})]})]})})}export{W as default};
